.TH MPSCP 1 "November 6 2008 " ""
.SH NAME
\fBmpscp\fP
\- high-performance remote file copy
.SH SYNOPSIS
.br
\fBmpscp\fP
[\fB\-prvBCaF\fP]
[\fB\-m\fP \fIpath-to-mpscp\fP]
[\fB\-S\fP \fIpath-to-ssh\fP]
[\fB\-o\fP \fIssh-options\fP]
[\fB\-P\fP \fIport\fP]
[\fB\-c\fP \fIcipher\fP]
[\fB\-i\fP \fIidentity\fP]
[\fB\-h\fP \fIhash\fP]
[\fB\-a\fP]
[[\fIuser\fP@]\fIhost1\fP:]\fIfilename1\fP
\fI...\fP
[[\fIuser\fP@]\fIhost2\fP:]\fIfilename2\fP
.SH DESCRIPTION
Non-encrypted, TCP-streams, host-to-host file copy utility
intended to enable greater transfer rates, while having the basic
user-interface concept of BSD
\fBrcp\fP(1).

The underlying design provides the opportunity to maximize
performance by allocating supplemental IP sockets as dedicated and
optimizable data-channels, in a mode similar to FTP.
Additionally, a parallel I/O scheme, based on the HPSS paradigm,
is also employed, offering potentials for multiple-sockets over a
single network connection (which, in many circumstances,
especially those in involving heterogeneous host platforms, or
large latency situations, can capture more bandwidth), and also
the distribution of the sockets across a manifold of parallel IP
network connections.
.SH OPTIONS
.TP
\fB\-a\fP
Alternate the direction of the data-socket connections.
The default has the local side listening and accepting,
while the remote connects.
In alternate mode, the remote side also looks to read a configuration file.
.TP
\fB\-m\fP \fIpath\fP
Specifies a variant path-to-
\fBmpscp\fP
executable on the remote side of the connection.  The default is
\fBmpscp\fP
(a relative path).
Note that you can use
"\fB\-m\fP"
to set environment variables and/or
command line options on the remote instance of
\fBmpscp\fP.
For example:
.nf
  mpscp -F -m "mpscp -F" local-file remoteHost:remote-file
.fi
.TP
\fB\-w\fP \fIwidth\fP 
Sets width of data-stripe;
i.e.; number of TCP-streams used in parallel.
Default is 1, maximum is 64.
.TP
\fB\-b\fP \fIblocksize\fP
Sets the blocksize for reads and writes in each data stream.
Default is 1048576, maximum is 33554432.
.TP
\fB\-h\fP \fIhash\fP
Selects the hash algorithm to use for message integrity checks.
Choices are "md5", "sha1", and the default "none".
When supported by OpenSSL choices for "sha224", "sha256", "sha384",
and "sha512" may also be available.
Use "none" for backwards compatibility with older versions of mpscp,
but please also add
"\fB\-p\fP"
as the method used resets the file date.
.TP
\fB\-c\fP \fIcipher\fP
Selects the cipher to use for encrypting the control channel
of the data transfer.  This option is directly passed to ssh.
.TP
\fB\-i\fP \fIidentity_file\fP
Selects the file from which the identity (private key) for
RSA authentication is read.
This option is directly passed to ssh.
.TP
\fB\-o\fP \fIssh-options\fP
Ssh options passed to ssh.
.TP
\fB\-p\fP
Preserves modification times, access times, and modes from the original file.
.TP
\fB\-r\fP
Recursively copy entire directories.
.TP
\fB\-v\fP
Verbose mode, useful in debugging connection, authentication, and
configuration problems.
Three levels are supported:
.br
\fB\-v\fP   :  Displays progress meter
.br
\fB\-vv\fP  :  Adds
\fBmpscp\fP
debugging messages.
.br
\fB\-vvv\fP :  Adds
\fBssh\fP
and
\fBscp\fP
debugging messages.
.TP
\fB\-P\fP \fIport\fP
Sets the port to connect to on the remote host.
Note that this option is written with a capital P, because
"\fB\-p\fP"
is already reserved for preserving the times and modes of the file in rcp.
Default is 22.
.TP
\fB\-F\fP
Use random data ports, as was the default in the original
\fBmpscp\fP.
The new default uses the TCP range 9000-9999,
as if these environment variables were set:
.nf
  setenv MPSCP_PORTS 'tcp[9000-9999]'
  setenv RPC_RESTRICTED_PORTS 'ncacn_ip_tcp[9000-9999]'
.fi
See also
"\fB\-m\fP", above.
.TP
\fB\-S\fP \fIpath-to-ssh\fP
Specifies the path to the
\fBssh\fP
program.
.SH ENVIRONMENT VARIABLES
.TP
.B MPSCP_CONFIG_FILENAME
The
.IR MPSCP_CONFIG_FILENAME
variable can be used to supply an alternate location for the
/usr/local/ossh/etc/mpscp_config file.
.TP
.B MPSCP_SERVER
Provides an alternate path-to-
\fBmpscp\fP
on the remote side of the connection, just like the
"\fB\-m\fP"
option.
.TP
.B MPSCP_DATA_IP
Specifies the IP address of the local interface to be used.
.TP
.B MPSCP_PORTS
Specifies the range of destination data ports.
The value must be formatted as: tcp[9000-9999]
.TP
.B RPC_RESTRICTED_PORTS
Specifies the range of source data ports. 
The value must be formatted as: ncacn_ip_tcp[9000-9999]
.TP
.B MPSCP_BLOCKED_FILE
The
.IR MPSCP_BLOCKED_FILE
variable can be used to supply an alternate location for the
/usr/local/ossh/etc/mpscp_blocked_ports file.
.SH FILES
.TP
/usr/local/ossh/etc/mpscp_config 
Default path for configuration file.
Can be reassigned dynamically with the environment variable
.IR MPSCP_CONFIG_FILENAME.
.PP
The following shows the formatting and an example for this file:
.nf

# Any numeric value coming as the first, non-white character
# on a line will be interpreted as an IP address to be used
# for a data channel. This seems like a bug in the inet_addr
# routines I have encountered on multiple vendor, unix 
# platforms, but I have accepted it as true.

# This machine has four OC-3 ATM to be utilized in parallel
132.175.26.150
192.168.1.3
192.168.2.3
192.168.3.3
# keyword "filesize" the first non-white string
# filesize                                         Optional
# key word  file size  I/O blocksize  Stripewidth  TCP window size
filesize   9999999999    1048576        16         262144
filesize    999999999    8388608         8
filesize     99999999    4194304         4
filesize      9999999    4194304         1

# This hierarchy of file sizes is a convoluted example.
# Also, they do not have to be listed in order as shown,
# the application will sort them to find the best match,
# as large as a listed size, less than the next larger.
.fi
.TP
/usr/local/ossh/etc/mpscp_blocked_ports
Default path for blocked ports file.
Can be reassigned dynamically with the environment variable
.IR MPSCP_BLOCKED_FILE.
.PP
The following shows an example for this file:
.nf

9000 9023 9024 9025 9026 9060 9082 9090 9100 9117 9148 9260
9284 9301 9325 9329 9400 9401 9536 9561 9563 9704 9870 9872
9873 9874 9875 9876 9877 9878 9879 9898 9900 9919 9989 9996
9999
.fi
.SH INSTALLATION
Similiar to
\fBscp\fP,
an executable mirroring the local side
\fBmpscp\fP
must be found on the remote host. The default is simply the name
\fBmpscp\fP;
which is the simplest approach:
the same name is expected to be on a users default login path.
This could be changed to a full path,
\fB\/usr/local/bin/mpscp\fP,
for instance, by modifying the Makefile, and recompiling.
Also, dynamically, the local shell environment variable,
.IR MPSCP_SERVER,
can be set, and finally the
"\fB\-m\fP"
option can be used on the command line.
.PP
For options such as multiple IP addresses for data channels,
or automatic assignments of stripe-widths and blocksizes based on file size,
a configuration file must be found by the local client
(or the remote side if the
"\fB\-a\fP"
option is used).
The default for this is hardcoded at
\fB\/usr/local/ossh/etc/mpscp_config\fP,
and, again, this has several opportunties for adjusting,
including the environment variable,
.IR MPSCP_CONFIG_FILENAME.
Also, the Makefile can reset this hardcoded pathname.
.SH SEE ALSO
\fBscp\fP(1),
\fBssh\fP(1),
\fBssh_config\fP(5)
